(this.webpackJsonppgc_admin_dev=this.webpackJsonppgc_admin_dev||[]).push([[35],{515:function(e,t,a){"use strict";t.a=function(e){return(e||"").split("").map((function(e,t){return 0===t?e.toUpperCase():"_"===e?" ":e.toLowerCase()})).join("")}},763:function(e,t,a){"use strict";a.r(t);var n=a(192),r=a(269),o=(a(272),a(196)),s=(a(274),a(203)),c=(a(167),a(71)),l=(a(191),a(50)),i=(a(83),a(38)),u=(a(267),a(99)),p=a(79),m=a(80),d=a(82),h=a(81),f=(a(268),a(130)),g=(a(194),a(91)),S=(a(131),a(54)),E=(a(166),a(98)),y=(a(197),a(132)),b=a(0),w=a.n(b),v=a(503),T=a(504),C=a(505),x=a(90),O=a(12),D=a(3),k=a.n(D),I=a(31),B=a.n(I),L=(a(114),a(198),a(133)),P=(a(190),a(84)),A=(a(276),a(205)),N=a(122),M=a(57),j=a(500),F=a(501),z=S.a.Option,R=function(e){var t=e.value,a=void 0===t?{}:t,n=e.onChange,r=Object(b.useState)(0),o=Object(M.a)(r,2),s=o[0],c=o[1],l=Object(b.useState)("true"),i=Object(M.a)(l,2),u=i[0],p=i[1];return w.a.createElement("span",null,w.a.createElement(S.a,{value:a.add||u,style:{width:"35%"},onChange:function(e){"add"in a||p(e)}},w.a.createElement(z,{value:"true"},w.a.createElement(j.a,null)," Add"),w.a.createElement(z,{value:"false"},w.a.createElement(F.a,null)," Substract")),w.a.createElement(A.a,{value:a.number||s,formatter:function(e){return"$ ".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,",")},parser:function(e){return e.replace(/\$\s?|(,*)/g,"")},style:{width:"65%"},onChange:function(e){var t,r=e;Number.isNaN(s)||("number"in a||c(r),t={number:r},n&&n(Object(N.a)(Object(N.a)({number:s,add:u},a),t)))},min:0}))},J=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(p.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).formRef=w.a.createRef(),e.onFinish=function(t){(0,e.props.customTransaction)(Object(N.a)(Object(N.a)({},t),{},{add:"true"===t.amount.add,amount:t.amount.number}))},e}return Object(m.a)(a,[{key:"render",value:function(){var e=this.props,t=e.visible,a=e.onClose,n=e.suppliers,r=e.customTransactionLoading;return w.a.createElement(L.a,{title:"New transaction",visible:t,onClose:a,destroyOnClose:!0,width:x.isMobile?360:426},w.a.createElement(P.a,{ref:this.formRef,onFinish:this.onFinish,layout:"vertical",initialValues:{price:{number:0,add:"true"}}},w.a.createElement(P.a.Item,{name:"email",label:w.a.createElement("span",{style:{fontFamily:"Poppins-Medium"}},"Select supplier"),rules:[{required:!0,message:"Please pick supplier"}]},w.a.createElement(S.a,{showSearch:!0,allowClear:!0,style:{width:"100%"},placeholder:"Select supplier",optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0||t.props.value.toLowerCase().indexOf(e.toLowerCase())>=0}},Array.isArray(n)&&n.map((function(e,t){return w.a.createElement(z,{key:t,value:e.email,children:e.firstName+" "+e.lastName})})))),w.a.createElement(P.a.Item,{name:"amount",label:w.a.createElement("span",{style:{fontFamily:"Poppins-Medium"}},"Amount"),rules:[{required:!0,message:"Please enter amount"}]},w.a.createElement(R,null)),w.a.createElement(P.a.Item,{name:"transactionID",label:w.a.createElement("span",{style:{fontFamily:"Poppins-Medium"}},"Transaction ID")},w.a.createElement(E.a,{placeholder:"Input transaction ID"})),w.a.createElement(P.a.Item,{name:"note",label:w.a.createElement("span",{style:{fontFamily:"Poppins-Medium"}},"Note")},w.a.createElement(E.a.TextArea,{rows:5,placeholder:"Input notes"})),w.a.createElement(P.a.Item,null,w.a.createElement(i.a,{type:"primary",htmlType:"submit",block:!0,loading:r},"Send"))))}}]),a}(b.Component),Y=a(109),G=a.n(Y),U=a(515),V=y.a.RangePicker,$=E.a.Search,_=S.a.Option,K={xs:24,sm:12,md:12,lg:12,xl:6,style:{marginBottom:24}},W=function(e){var t=e.title,a=e.content,n=e.tooltip,r=e.className;return w.a.createElement(f.a,{title:t,extra:w.a.createElement(g.a,{title:n},w.a.createElement(v.a,null)),bordered:!1,loading:!1,headStyle:{border:"none"},bodyStyle:{paddingTop:"10px",paddingBottom:"15px"},style:{borderRadius:"0",borderRight:"1px solid #f0f0f0"}},w.a.createElement("span",{className:k()(G.a.text,r)},a))},q=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(p.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={pageSize:10,totalElements:0,currentPage:0,keyword:"",startDate:null,endDate:null,status:void 0,openNewTransaction:!1},e.checkParamOverview=function(){var t=e.state.supplierId,a={};return t&&(a.supplierId=t),a},e.checkParam=function(){var t=e.state,a=t.currentPage,n=t.pageSize,r=t.sortedInfo,o=t.keyword,s=t.startDate,c=t.endDate,l=t.supplierId,i=t.status,u={};return r&&r.order&&r.columnKey&&(u.sort="".concat(r.columnKey,",").concat(r.order)),o&&(u.keyword=o),s&&c&&(u.startDate="".concat(s.format("YYYY-MM-DDT00:00:00.000"),"Z"),u.endDate="".concat(c.format("YYYY-MM-DDT23:59:59.000"),"Z")),l&&(u.supplierId=l),i&&(u.status=i),u.page=a,u.size=n,u},e.refreshTable=function(){e.setState({currentPage:0},(function(){return e.props.fetchAllBalances(e.checkParam())}))},e.export=function(){},e.onChangeDate=function(t){t?e.setState({startDate:t[0],endDate:t[1]},e.refreshTable):e.setState({startDate:null,endDate:null},e.refreshTable)},e.onSearch=function(){e.refreshTable()},e.debounceSearch=O.debounce((function(t){e.setState({keyword:t.trim()},(function(){1!==t.length&&e.refreshTable()}))}),300),e.onChangeKeyWord=function(t){e.debounceSearch(t.target.value)},e.onChangeSupplier=function(t){e.setState({supplierId:t},(function(){e.refreshTable(),e.props.fetchOverview(e.checkParamOverview())}))},e.onChangeStatus=function(t){e.setState({status:t},e.refreshTable)},e.onShowSizeChange=function(t,a){e.setState({pageSize:a},e.refreshTable)},e.openNewTransaction=function(){e.setState({openNewTransaction:!0})},e.handleTableChange=function(t,a,n){e.setState({currentPage:t.current-1},(function(){return e.props.fetchAllBalances(e.checkParam())}))},e.checkStatus=function(e){switch(e){case"APPROVED":return"success";case"PENDING":return"warning";case"REJECTED":return"yellow";case"DEBT":return"error"}},e}return Object(m.a)(a,[{key:"componentDidMount",value:function(){this.props.fetchAllBalances(this.checkParam()),this.props.fetchOverview(this.checkParamOverview()),this.props.getAllSupplier()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this,a=this.props,n=a.customTransactionSuccess,r=a.customTransactionError,o=a.exportError;e.customTransactionSuccess&&e.customTransactionSuccess!==n&&u.b.success("Custom transaction success!",(function(){t.setState({openNewTransaction:!1}),t.refreshTable()})),e.customTransactionError&&e.customTransactionError!==r&&u.b.error("Custom transaction error!"),e.exportError&&e.exportError!==o&&u.b.error("Export error!")}},{key:"render",value:function(){var e=this,t=this.state,a=t.currentPage,n=t.pageSize,r=t.openNewTransaction,u=(t.startDate,t.endDate,this.props),p=u.listBalances,m=u.overView,d=u.listSuppliers,h=u.customTransaction,g=u.customTransactionLoading,y=u.exportTransaction,b=u.exportLoading,v=p.balances,D=p.loading,k=p.totalElements,I=m.data,L=d.suppliers;return w.a.createElement(w.a.Fragment,null,w.a.createElement(f.a,{title:w.a.createElement("div",{style:{display:"flex",alignItems:"center"}},w.a.createElement(T.a,{style:{marginRight:"5px"}}),w.a.createElement("span",{style:{marginRight:"16px"}},"BALANCE OVERVIEW"),w.a.createElement(S.a,{showSearch:!0,allowClear:!0,style:{width:"200px"},placeholder:"Filter by Supplier",onChange:this.onChangeSupplier,optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0||t.props.value.toLowerCase().indexOf(e.toLowerCase())>=0}},Array.isArray(L)&&L.map((function(e,t){return w.a.createElement(_,{key:t,value:e.id,children:e.firstName+" "+e.lastName})})))),headStyle:{color:"rgba(0, 0, 0, 0.45)"},bodyStyle:{paddingBottom:"12px"},extra:w.a.createElement(w.a.Fragment,null,w.a.createElement(i.a,{type:"link",icon:w.a.createElement(C.a,null),onClick:y,style:{marginRight:"16px"},size:x.isMobile?"small":"middle",loading:b},"Export"),w.a.createElement(i.a,{type:"primary",size:x.isMobile?"small":"middle",onClick:this.openNewTransaction},"New transaction")),loading:m.loading},w.a.createElement(c.a,{gutter:24,type:"flex"},w.a.createElement(l.a,K,w.a.createElement(W,{className:G.a.red,title:"UPCOMING AMOUNT",content:"$".concat(parseFloat(O.get(I,"upcomingAmount",0)).toLocaleString("en-GB")),tooltip:"Upcoming Amount = Supplier Cost - Paid amount"})),w.a.createElement(l.a,K,w.a.createElement(W,{className:G.a.black,title:"PAID AMOUNT",content:"$".concat(parseFloat(O.get(I,"paidAmount",0)).toLocaleString("en-GB")),tooltip:"The total money that admin paid to Supplier"})))),w.a.createElement(f.a,{style:{marginTop:"25px"}},w.a.createElement(E.a.Group,null,w.a.createElement(c.a,{gutter:24},w.a.createElement(l.a,{md:8,xs:24},w.a.createElement($,{allowClear:!0,onSearch:this.onSearch,onChange:this.onChangeKeyWord,style:{width:"100%"},placeholder:"Search by transaction ID or created by"})),w.a.createElement(l.a,{md:4,xs:24},w.a.createElement(V,{ranges:{Today:[B()(),B()()],Yesterday:[B()().add(-1,"days"),B()().add(-1,"days")],"Last 7 days":[B()().subtract(6,"days"),B()()],"Last 30 days":[B()().subtract(29,"days"),B()()],"This Month":[B()().startOf("month"),B()().endOf("month")],"Last Month":[B()().subtract(1,"months").startOf("month"),B()().subtract(1,"months").endOf("month")]},showTime:!!x.isMobile,format:"DD/MM/YYYY",onChange:this.onChangeDate,style:{width:"100%"}})),w.a.createElement(l.a,{md:4,xs:24},w.a.createElement(S.a,{showSearch:!0,allowClear:!0,style:{width:"100%"},placeholder:"Filter by status",onChange:this.onChangeStatus,optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0||t.props.value.toLowerCase().indexOf(e.toLowerCase())>=0}},w.a.createElement(_,{value:"DEBT"},"Upcoming amount"),w.a.createElement(_,{value:"APPROVED"},"Approved"))),w.a.createElement(l.a,{md:4,xs:24}))),w.a.createElement("br",null),w.a.createElement(o.a,{rowKey:function(e){return e.id},dataSource:v,columns:[{title:"Supplier",dataIndex:"email",key:"email"},{title:"ID",dataIndex:"number",key:"number",ellipsis:!x.isMobile,render:function(e){return"#"+e}},{title:"Amount",dataIndex:"amount",key:"amount",render:function(e){return e<0?"-$"+Math.abs(e).toLocaleString("en-GB"):"$"+parseFloat(e).toLocaleString("en-GB")}},{title:"Transaction ID",dataIndex:"transactionId",key:"transactionId"},{title:"Created by",dataIndex:"createdBy",key:"createdBy"},{title:"Created Date",dataIndex:"createdDate",key:"createdDate",render:function(e){return new Date(e).toLocaleString("en-GB")}},{title:"Status",dataIndex:"status",key:"status",render:function(t){return w.a.createElement(s.a,{status:e.checkStatus(t),text:"DEBT"===t?"Upcoming amount":Object(U.a)(t)})}},{title:"Note",dataIndex:"note",key:"note",render:this.renderNote,width:200}],pagination:{current:a+1,pageSize:n,total:k,showSizeChanger:!0,onShowSizeChange:this.onShowSizeChange,showLessItems:!0,showQuickJumper:!0,showTotal:function(e){return"Total ".concat(e," balances")}},loading:D,showSizeChanger:!0,onShowSizeChange:this.onShowSizeChange,onChange:this.handleTableChange})),w.a.createElement(J,{visible:r,onClose:function(){return e.setState({openNewTransaction:!1})},suppliers:L,customTransaction:h,customTransactionLoading:g}))}}]),a}(b.Component);t.default=Object(n.b)((function(e){return{listBalances:e.toJS().supplierBalances.listBalances,overView:e.toJS().supplierBalances.overView,listSuppliers:e.toJS().orders.listSuppliers,customTransactionLoading:e.toJS().userBalances.customTransactionLoading,customTransactionSuccess:e.toJS().userBalances.customTransactionSuccess,customTransactionError:e.toJS().userBalances.customTransactionError,exportLoading:e.toJS().userBalances.exportLoading,exportSuccess:e.toJS().userBalances.exportSuccess,exportError:e.toJS().userBalances.exportError}}),(function(e){return{fetchAllBalances:function(t){e(r.n.fetchAllBalances(t))},fetchOverview:function(t){e(r.n.fetchOverview(t))},getAllSupplier:function(){e(r.h.getAllSupplier())},customTransaction:function(t){e(r.p.customTransaction(t))},exportTransaction:function(){e(r.n.exportOrder())}}}))(q)}}]);
//# sourceMappingURL=35.94d83cc0.chunk.js.map